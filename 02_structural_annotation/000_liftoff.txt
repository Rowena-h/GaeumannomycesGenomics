for f in {Gt-19d1,Gt-4e,Gh-2C17,Gh-1B17,Gt-3aA1,Gt-8d,Gt-CB1,Gt14LH10,Gt-23d}; do mkdir -p ${f}/Analysis/liftoff-1.5.1_CBG/ ; cd ${f}/Analysis/liftoff-1.5.1_CBG/ ;genome=$(basename ../../Reference/Genome/*fa) ;  sbatch -J ${f}_liftoff -o ${f}_liftoff_%j_%N.out -e ${f}_liftoff_%j_%N.err --mail-type=end,fail --mail-user=olivera@nbi.ac.uk -c 4 --mem=12G -p ei-cb --wrap " source liftoff-1.5.1_CBG && liftoff -p 4 -a 1 -s 0.5 -g /ei/.project-scratch/d/d2c0bfb1-c37a-4211-9493-86b15d4e773e/CB-GENANNO-520_Mark_McMullan_Wheat_Take-all/Reference/Mikado_Sordariomycetes/NCBI_annotations/GCF_000145635.filtered.gff -o ${f}_liftoff.gff  ../../Reference/Genome/${genome}  /ei/.project-scratch/d/d2c0bfb1-c37a-4211-9493-86b15d4e773e/CB-GENANNO-520_Mark_McMullan_Wheat_Take-all/Reference/Mikado_Sordariomycetes/NCBI_genomes/GCF_000145635.1.fasta" ; cd - ;done

for f in {Gt-19d1,Gt-4e,Gh-2C17,Gh-1B17,Gt-3aA1,Gt-8d,Gt-CB1,Gt14LH10,Gt-23d}; do cd ${f}/Analysis/liftoff-1.5.1_CBG/ ; genome=$(basename ../../Reference/Genome/*fa) ; cp /ei/.project-scratch/d/d2c0bfb1-c37a-4211-9493-86b15d4e773e/CB-GENANNO-520_Mark_McMullan_Wheat_Take-all/Analysis/multi_genome_compare.liftoff* ./ ;sed -i "s/Gt-19d1/${f}/g" multi_genome_compare.liftoff.config.yaml ; sed -i "s/reference_genome.fa/${genome}/g" multi_genome_compare.liftoff.config.yaml ; sed -i "s/target_liftoff.gff/${f}_liftoff.gff/g" multi_genome_compare.liftoff.config.yaml ; sbatch -c 4 --mem 10G -p ei-medium -o ${f}_multi_genome_compare.%j.log -J ${f}_multi_genome_compare --mail-type=fail,end --mail-user=olivera@nbi.ac.uk --wrap 'source python_miniconda-4.8.3_py3.8_gk_DONOTUSE && snakemake --configfile multi_genome_compare.liftoff.config.yaml --snakefile multi_genome_compare.liftoff.smk --cores 4' ; cd - ;done


for f in {Gt-19d1,Gt-4e,Gh-2C17,Gh-1B17,Gt-3aA1,Gt-8d,Gt-CB1,Gt14LH10,Gt-23d}; do cd ${f}/Analysis/liftoff-1.5.1_CBG/output_multi_genome_compare/ ;source gffread-0.12.2_CBG && gffread -T -o target_liftoff.gtf target_liftoff.gff3; cut -f 1,2,4,6,9,12,13,16,19,22,23 out_pairwise |column -t -s $'\t' |awk ' $5 >= 50 &&  $6  >= 100 && $9  >= 100 && $10 >= 100.00' > out_pairwise_50; cut -d ' ' -f1 out_pairwise_50 > out_pairwise_50_list ; cat target_liftoff.gtf |cut -f 9 |cut -d '"' -f2,4 |sed 's/"/\t/g' |sort -u > all_transcript_gene.txt; grepf_gemy.pl out_pairwise_50_list all_transcript_gene.txt > out_pairwise_50_list_transcript_gene.txt; source mikado-2.3.3_CBG && mikado util grep out_pairwise_50_list_transcript_gene.txt target_liftoff.gtf liftover_${f}.gtf; source gffread-0.12.2_CBG; gffread -F -C --keep-genes liftover_${f}.gtf |  sed 's/transcript/mRNA/g' > liftover_${f}.gff; cd - ;done
